# 镜像FAQ
 
## 概念及一般性问题
### 镜像和快照有什么关系？
镜像和快照本质都是数据副本，但是作为云资源，由于具有不同的元数据（资源属性），因此用途和使用场景有所不同。<br>

为实例制作私有镜像时，会对实例挂载的云硬盘分别制作快照，并记录其关联关系，因此镜像虽然只是快照的引用，但是它同时还记录了实例的操作系统信息、云硬盘的设备索引信息、镜像来源等等，而对于快照来说，只记录云硬盘的相关信息，并不关心云盘的用途。因此镜像可以用来创建一个完整的实例，而快照只能创建或回滚一块云硬盘。

### 本地系统盘镜像和云盘系统盘镜像有什么区别？
两种镜像主要差别在于其系统盘备份文件的格式不同，镜像类型决定了系统盘类型，同样的，为实例制作镜像时其系统盘类型也决定了镜像类型。相比于本地盘，云硬盘具有高可靠、高可用、弹性扩展等特性，同时，云硬盘系统盘的主机还具有启动快、备份快（增量备份）、支持开机状态制作镜像等优势，相较于本地盘更适合用作系统盘数据持久化存储介质。<br>

本地系统盘已逐步下线，后续将只支持使用云硬盘作为系统盘，建议通过[镜像类型转换](https://docs.jdcloud.com/virtual-machines/convert-image)基于本地系统盘生成云盘系统盘后使用。

### 使用镜像创建实例时对所选规格是否有限制？
目前镜像和规格使用存在以下限制：
* 三代及三代以上实例规格，以及二代规格中的裸金属规格、存储优化大数据型（s.d1/s.d2）突发性能型（t.）**仅支持云盘系统盘镜像**；
* 三代实例规格，**不支持Windows Server 2008镜像**；
* 二代裸金属规格**仅支持CentOS 7.2、CentOS 7.4及CentOS 7.6镜像**，三代裸金属规格**仅支持CentOS 7.4及CentOS 7.6镜像**；
* C模式GPU虚拟化型规格**仅支持Linux操作系统**。

## 创建自定义镜像
### 是否支持基于快照创建自定义镜像？
基于实例创建自定义镜像时，如通过OpenAPI或CLI创建，支持指定快照作为镜像的数据盘，并可通过指定devicename定义镜像的devicemapping。

### 是否支持开机状态制作私有镜像？
云盘系统盘实例支持开机状态制作私有镜像，本地盘系统盘实例须停机后制作。

### 是否支持创建包含本地数据盘的镜像？
不支持，本地数据盘是临时存储，制作私有镜时仅包含实例挂载的云硬盘数据盘。本地数据盘在发生迁移或宿主机宕机等情况时有丢失数据的风险，不适用于应用层没有数据冗余架构的使用场景，建议您使用云硬盘存储重要数据。

### 自定义镜像删除后是否影响使用镜像创建的实例？
不影响已创建实例，但镜像删除后实例将无法使用该镜像初始化系统盘，还请谨慎操作。

### 是否支持定期自动制作镜像？
支持，可通过[自动镜像策略](https://docs.jdcloud.com/cn/virtual-machines/autoimagepolicy)实现。

### 创建镜像一般需要多长时间？
镜像创建的时间取决于磁盘内数据实际大小，如果制作整机镜像，需要同时对多个磁盘制作快照，全部快照制作完成后镜像才可使用。

## 镜像类型转换
### 云盘系统盘镜像支持转换成本地系统盘镜像么？
不支持，仅支持本地系统盘镜像转换成云盘镜像。

### 本地系统盘镜像转换成云盘系统盘镜像后，原本地盘镜像还在么？
镜像类型转换只是基于本地盘镜像生成一个数据完全一致的云盘系统盘镜像，原本地盘镜像仍可继续使用。

### 可以将其他用户共享的本地系统盘镜像转换后使用么？
不可以，镜像共享后被共享对象只拥有镜像的使用权限，即使用镜像创建实例，其他镜像操作权限只属于拥有者。建议使用共享的镜像创建实例后，生成本地系统盘镜像，再转换为云盘系统盘镜像使用。

## 镜像复制
### 镜像复制对镜像有什么要求？
仅支持对“可用”状态的云盘系统盘私有镜像进行复制操作，同时须确保镜像及其关联的快照没有其他进行中的任务。

### 是否支持同地域复制？
不支持，只能将镜像复制到除所在地域外的其他地域。

### 复制镜像是否收费？
复制操作本身是免费的，复制成功后，副本镜像关联的快照可能产生相关费用，详见[云硬盘快照计费规则](https://docs.jdcloud.com/cloud-disk-service/snapshot-billing-rules)。

### 复制镜像过程中，源镜像是否可以进行其他操作？
复制操作不会改变源镜像的状态，但在复制操作完成前，源镜像不可删除，不可再次提交复制请求，其余操作（查看、修改信息、共享、创建实例等）不受影响。

### 是否支持跨账号复制镜像？
不支持，跨账号使用镜像须通过镜像共享操作实现。

### 复制一个镜像需要多久？
复制镜像所需的时间取决于镜像关联快照的实际大小，可在目标地域查看镜像镜像复制完成进度。

## 镜像导入/导出
### 导入/导出镜像控制台是否有操作入口？
控制台操作入口目前为灰度开放，如需使用请提交工单申请权限。

### 导入镜像后镜像显示为错误状态，如何查看原因？
可通过OpenAPI或CLI调用[镜像任务查询](https://docs.jdcloud.com/virtual-machines/api/imagetasks?content=API)接口查看任务进度及失败原因。

### 导出镜像后在对应Bucket下查看不到文件是什么原因？
如果长时间看不到镜像文件，可能是由于权限等原因导致导出失败，可通过OpenAPI或CLI调用[镜像任务查询](https://docs.jdcloud.com/virtual-machines/api/imagetasks?content=API)接口查看任务进度及失败原因。

## 镜像共享
#### 每个镜像可以共享给多少个用户？
单个私有镜像最多可共享给10个用户，如需共享给更多用户，可提交工单申请。

### 我最多可以获得多少个共享镜像？
无限制，可以被共享任意多个其他用户的私有镜像。

### 别人共享给我的镜像是否可以共享给其他用户？
不可以，镜像共享不支持级联授权。

### 共享给其他用户镜像有什么使用限制？
无使用限制，仅在删除时须先解除共享关系。

## 镜像删除
### 创建了实例的私有镜像是否可以删除？
云盘系统盘私有镜像可以随时删除，本地系统盘镜像如有使用镜像创建的实例，为避免物理机宕机后实例无法恢复，不允许删除。

### 删除镜像时选择了删除关联快照，但镜像删除后快照仍在是什么原因？
如通过镜像类型转换功能，将一个本地系统盘镜像转换成了云盘系统盘镜像，源本地盘镜像中的数据盘快照会同时被两个镜像引用，这种情况下删除两个镜像中的任意一个时，由于还存在引用关系，因此快照仍会保留。

## 镜像收费 
### 镜像如何收费？
目前官方镜像和镜像市场镜像均为免费使用，即使用镜像创建实例时无需支付镜像相关费用。但由于私有镜像本质是对云硬盘备份数据（快照）的引用，而云硬盘快照目前已经商业化，因此保有私有镜像会产生一定的快照保存费用，具体收费标准详见[云硬盘快照计费规则](https://docs.jdcloud.com/cloud-disk-service/snapshot-billing-rules)。
