# 突发性能型实例概述
突发性能型实例（以下简称为：突发型实例）是一种通过积分机制约束CPU使用率的实例规格，适用于平时CPU使用率较低，偶发使用率突增的入门级或轻量级计算场景。突发型实例提供了在一定时间区间内动态分配计算力的能力，闲时积累忙时消耗，相对于普通实例规格，更为经济。

>提示：突发性能型实例目前处于公测中，如需购买请提交工单申请权限。

## 核心机制
实例运行过程中，CPU使用率存在一定波动性，而在选择普通实例规格时，通常会考虑峰值使用率来选择CPU配置，对于多数时间处于低使用率的场景存在一定的计算力浪费。<br>

突发型实例引入了一个新的配置参数，即 **基准性能**，以百分比形式表示，系统会根据配置（核数）和基准性能实时为实例提供计算力，并允许计算力的积累，实例在运行消耗计算力的过程中，以基准性能运行时计算力收支平衡，低于基准性能运行时计算力会累积，而在业务高峰时可以消耗累积的计算力实现CPU使用率的突发，累积计算力耗尽后系统又会限制实例使用率至基准性能。

为了量化计算力，我们引入了**CPU积分**的概念，将1积分定义为等同于1个vCPU以100%使用率运行1分钟所完成的计算力。这样实例积累或消耗的计算力都可以换算成积分，而无需同时关注核数、使用率和持续时间这3个反映计算力的维度。关于积分的累积、消耗等使用趋势，可在实例详情页监控Tab内查看，详细说明可参考 [CPU积分示例]()。

CPU积分累积具有上限，不同规格可累积的最大积分有所不同。同时，突发型实例具有两种性能模式，积分不足时“有约束模式下”使用率会被约束在基准性能，“无约束模式”下则不受基准性能约束，但可能产生额外费用，下文会做详细介绍。

>注意：<br>
>积分主要用于量化实例自身CPU消耗情况，以便做统计、展示和计费，并非实际场景下完成计算任务的标准量度，不建议以积分作为性能参数用于不同实例间比较。

## 适用场景

相比于普通规格的“按配置”购买，突发型实例的理念更接近于“按计算力”购买。普通实例规格在购买后，无论CPU使用情况如何都相当于对全部vCPU付费，而突发型实例规格中的vCPU本质是计算能力上限，相对于此上限的基准性能百分比才是实际付费购买的计算力，同时由于在一定时间内允许计算力的累积，因此可以尽可能的避免所购计算力的浪费。所以，如果您的业务CPU使用率比较规律，仅在特定的时段需要维持较高的CPU性能，其他时段积累的算力可以满足突发阶段使用，那么可以根据当前使用率情况选择合适的突发型实例规格。

通常情况下，微服务、代码库、轻负载应用、web服务、开发测试环境等场景可以考虑选择突发型实例。在购买前建议综合CPU的峰值、平均值和波动趋势选择合适的规格，如果使用过程中出现性能无法满足的情况，可随时通过调整配置功能调整至其他突发型规格或普通实例规格。

## 基本概念
>注：示例中t.c2.large规格配置为：2C4GB，20%基准性能。

<table>
	<thead>
    <tr>
        <th align="left">概念</th>
      	<th align="left">说明</th>
      	<th align="left">示例</th>
    </tr>
  	</thead>
    <tbody>     
    <tr>
        <td width="140">积分</td>
      	<td width="500">积分是计算力归一化的一个度量单位，1积分等同于1个vCPU以100%使用率运行1分钟所完成的计算力（vCPU×使用率×运行时间=1）。</td>
      	<td> 1个vCPU以50%使用率，运行2分钟，相当于消耗1个积分；<br>2个vCPU以25%使用率，运行2分钟，同样相当于消耗1个积分。 </td>
    </tr> 
    <tr>
        <td>基准性能</td>
      	<td>实例可以持续获得的CPU性能，是一个相对值，以百分比的形式表示，其参考对象为实例规格中的vCPU。<br>当实例以基准性能运行时，每分钟消耗的积分等于系统发放的积分。</td>
      	<td>以t.c2.large为例，基准性能为20%，即系统发放的积分可以保证实例以20%使用率持续运行。</td>
    </tr> 
    <tr>
        <td>CPU积分余额</td>
      	<td>突发实例低于基准性能运行时累积的积分，可用于后续性能突发。</td>
      	<td>以t.c2.large为例，假如实例始终以10%的CPU使用率运行，1分钟可累积 2(vCPU)×10%(基准性能-实际性能)×1（分钟）=0.2积分。启动后持续运行10分钟时，CPU积分余额为2积分。</td>
    </tr> 
    <tr>
        <td>积分余额上限</td>
      	<td>积分余额上限是指最大可累积的CPU积分余额。<br>1台突发型实例24小时可获得CPU积分即为其积分上限，不同规格上限不同，到达上限后积分将不再累积。</td>
      	<td>以t.c2.large为例，积分上限为：2(vCPU)×20%(基准性能)×60(分钟)=24积分。</td>
    </tr>           
    <tr>
        <td>CPU消耗积分</td>
      	<td>只要突发实例运行就会消耗积分，是积分视角下实例运行情况的反应，其趋势与CPU使用率一致。</td>
      	<td>以t.c2.large为例，假如实例始终以5%的CPU使用率运行，每分钟会消耗 2(vCPU)×5%(基准性能-实际性能)×1（分钟）=0.1积分。</td>
    </tr>      
    <tr>
        <td>CPU预支积分</td>
      	<td>开启无性能约束模式时，允许在积分余额为0时向系统预支一定积分用于性能突发，预支积分上限为24小时可获得的CPU积分。<br>存在预支积分的情况下，低于基准性能运行所累积的积分会优先偿还预支积分。</td>
      	<td>以t.c2.large为例，假如实例开启无性能约束模式后，则其预支积分上限为：2(vCPU)×20%(基准性能)×60(分钟)×24(小时)=576积分。</td>
    </tr>  
    <tr>
        <td>CPU超额积分</td>
      	<td>预支积分消耗完毕后，如继续以高于基准性能的CPU使用率运行，所使用的积分为超额积分。<br>存在超额积分的情况下，低于基准性能运行所累积的积分会优先偿超额支积分，系统每小时会针对超额积分结算收费。</td>
      	<td>以t.c2.large为例，假如实例开启无性能约束模式后，性能突发预支了20个积分，随后使用率下降至基准性能以下并在结算时刻已偿还了10个积分。那么需要额外支付10个积分的费用 。</td>
    </tr>        
</tbody>
</table>

## 性能模式

突发型实例的运行模式分为**有性能约束模式** 和 **无性能约束模式**，默认为有约束模式。<br>

* **有性能约束模式**（以下简称为：有约束模式）：<br>

  有约束模式下，突发实例的性能受限于CPU积分。积分余额=0时，实例将只能以不高于基准性能的使用率运行，积分余额>0时，突发场景下使用率提升后的持续时间完全取决可用积分情况。由于不会产生预支和超额积分，因此不会产生额外积分费用。<br>
  
* **无性能约束模式下**（以下简称为：无约束模式）：<br>
  
  无约束模式下，突发实例的性能将不受限于CPU积分，积分余额耗尽后，可以使用预支积分和超额积分使实例以高于基准性能的CPU使用率持续运行。超额积分和预支积分都有一定的偿还期限，超额积分产生后须在下一个整点时刻之前偿还，系统会在整点时刻结算超额积分；预支积分只在实例调配、调整性能模式或删除时进行结算，在此类操作进行前只要偿还完毕就无需支付额外费用。
  
有约束模式适合于负载稳定且规律，突发情况持续时间较短，或及时受限于积分无法突发也对业务影响不大的应用。如果期望负载较高时CPU性能不受积分限制可开启或阶段性开启无约束模式。
  
## 实例规格
现提供以下几种突发型实例规格。
#### 规格类型与特点
* 实例采用非绑定CPU调度模式，每个vCPU会被分配到任何空闲的超线程核上，不同实例的vCPU可以互相争抢物理CPU资源。突发性能型实例拥有高性价比的优点，但由于需要对资源进行争抢，在性能上可能会受到不同程度的影响。
* 处理器：2.6 GHz主频的Intel Xeon Gold 6267（Cascade Lake）处理器
* 系统盘：仅支持云硬盘

实例规格|vCPU（核）|内存（GB）|基准性能 |弹性网卡|网卡多队列 |每小时可获积分 | 积分余额上限
|:---|:---|:---|:--- |:---|:---|:---|:---
|t.e2.small|2|1|10% |2|1 |12 |288
|t.e2.large|2|2|20% |2|1 | 24 |576
|t.c2.large|2|4|20% |2|1 | 24 |576
|t.g2.large|2|8|30% |2|1 | 36|864
|t.e2.xlarge|4|4|30% |2|1 | 72 |1728
|t.c2.xlarge|4|8|30% |2|1 | 72 |1728
|t.g2.xlarge|4|16|40% |2|1| 96 | 2304
|t.e2.2xlarge|8|8|30% |2|1 | 144| 3456
|t.c2.2xlarge|8|16|30% |2|1 | 144| 3456
|t.g2.2xlarge|8|32|40% |2|1| 192|4608

## 实例操作对积分的影响
#### 停止
* 包年包月计费实例，停止实例后积分照常下发，直至到达积分上限；
* 按配置计费实例
  * 未配置停机不计费，停止后积分照常下发，直至到达积分上限；
  * 配置停机不计费，停止后由于实例不再收费，积分停止下发。
#### 调整配置
* 突发型实例调整为普通实例规格时，如有预支积分或超额积分会一次性结算，如有积分余额会清零不做保留。
* 突发型实例调整为其他突发型实例规格时，如有预支积分或超额积分会一次性结算，如有积分余额则保留继续使用。
#### 删除
* 实例删除时，如有预支积分或超额积分会一次性结算，如有积分余额会清零不做保留。
#### 调整性能模式
* 在有约束模式和无约束模式间调整时，如有预支积分或超额积分会一次性结算，如有积分余额会保留。
#### 积分欠费
* 由于实例和积分是单独结算扣费的，因此可能出现按配置计费实例扣费成功后，积分扣费失败导致欠费的情况，此情况下不会影响实例运行状态，但系统会限制实例至基准性能。
